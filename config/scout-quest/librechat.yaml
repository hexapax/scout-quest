# ============================================
# Scout Quest — LibreChat Configuration
# ============================================
# Locked-down instance with curated model presets
version: 1.2.8
cache: true

# --- Registration ---
registration:
  socialLogins:
    - google

# --- Memory (disabled — quest state lives in MCP/MongoDB now) ---
memory:
  disabled: true

# --- Speech (voice that stays in-context) ---
speech:
  stt:
    openai:
      apiKey: "${STT_API_KEY}"
      model: "whisper-1"
  tts:
    openai:
      apiKey: "${TTS_API_KEY}"
      model: "tts-1"
      voices:
        - "nova"
        - "alloy"
        - "echo"
        - "fable"
        - "onyx"
        - "shimmer"

# --- MCP Servers ---
mcpServers:
  scout-quest:
    type: stdio
    command: node
    args:
      - "/app/mcp-servers/scout-quest/dist/scout.js"
    env:
      MONGO_URI: "mongodb://mongodb:27017/scoutquest"
      NTFY_TOPIC: "${NTFY_TOPIC}"
      SCOUT_EMAIL: "{{user.email}}"
    timeout: 30000
    serverInstructions: true
  scout-guide:
    type: stdio
    command: node
    args:
      - "/app/mcp-servers/scout-quest/dist/guide.js"
    env:
      MONGO_URI: "mongodb://mongodb:27017/scoutquest"
      NTFY_TOPIC: "${NTFY_TOPIC}"
      GUIDE_EMAIL: "{{user.email}}"
    timeout: 30000
    serverInstructions: true

# --- Custom Endpoints (cheaper / open-source models) ---
endpoints:
  custom:
    # DeepSeek — very cheap, strong reasoning
    - name: "Deepseek"
      apiKey: "${DEEPSEEK_API_KEY}"
      baseURL: "https://api.deepseek.com/v1"
      models:
        default:
          - "deepseek-chat"
          - "deepseek-reasoner"
        fetch: false
      titleConvo: true
      titleModel: "deepseek-chat"
      modelDisplayLabel: "Deepseek"

    # OpenRouter — gateway to dozens of open models
    - name: "OpenRouter"
      apiKey: "${OPENROUTER_KEY}"
      baseURL: "https://openrouter.ai/api/v1"
      models:
        default:
          - "google/gemma-3-27b-it"
          - "meta-llama/llama-4-scout"
          - "meta-llama/llama-3.3-70b-instruct"
          - "mistralai/mistral-small-3.1-24b-instruct"
          - "qwen/qwen-2.5-72b-instruct"
        fetch: true
      titleConvo: true
      titleModel: "current_model"
      summarize: false
      summaryModel: "current_model"
      dropParams:
        - "stop"
      modelDisplayLabel: "OpenRouter"

# --- Model Specs (lock UI to curated presets) ---
modelSpecs:
  enforce: true
  prioritize: true
  list:
    - name: "Scout Coach (Claude)"
      label: "Scout Coach"
      description: "Your AI Scout Coach — best for merit badge help, quest planning, and advancement tracking"
      preset:
        endpoint: "anthropic"
        model: "claude-sonnet-4-6"
        maxOutputTokens: 4096
        mcpServers:
          - "scout-quest"
        promptPrefix: |
          You are Scout Coach, an AI mentor guiding Boy Scouts through Personal
          Management and Family Life merit badges via a personally meaningful
          savings quest.

          CRITICAL: You have MCP tools and resources available. You MUST actually
          call them — never simulate or pretend to use tools. Read your MCP
          resources at session start. If a tool call fails, report the error.

          Scout profiles and advancement data come from Scoutbook (Scouting
          America's official system). You cannot create scouts — they are synced
          automatically from the troop roster. If no profile is found for the
          current user, tell them to check their Scoutbook registration.

          Follow the SESSION START protocol in the MCP server instructions.
          Adopt the character persona from scout://character.
          Keep responses encouraging, age-appropriate, and matched to the
          scout's message length.
          Use gamification, intermediate milestones, and the quest overlay
          vocabulary to keep daily tracking engaging over the full 13-week journey.
          Scouts can also ask about any of their advancement progress (ranks,
          merit badges, awards) — this data is synced from Scoutbook.

    - name: "Scout Coach (Gemini)"
      label: "Scout Coach (Gemini)"
      description: "AI Scout Coach powered by Gemini 3 Flash — great tool use at lower cost"
      preset:
        endpoint: "google"
        model: "gemini-3-flash"
        temperature: 0.7
        maxOutputTokens: 4096
        mcpServers:
          - "scout-quest"
        promptPrefix: |
          You are Scout Coach, an AI mentor guiding Boy Scouts through Personal
          Management and Family Life merit badges via a personally meaningful
          savings quest.

          CRITICAL: You have MCP tools and resources available. You MUST actually
          call them — never simulate or pretend to use tools. Read your MCP
          resources at session start. If a tool call fails, report the error.

          Scout profiles and advancement data come from Scoutbook (Scouting
          America's official system). You cannot create scouts — they are synced
          automatically from the troop roster. If no profile is found for the
          current user, tell them to check their Scoutbook registration.

          Follow the SESSION START protocol in the MCP server instructions.
          Adopt the character persona from scout://character.
          Keep responses encouraging, age-appropriate, and matched to the
          scout's message length.
          Use gamification, intermediate milestones, and the quest overlay
          vocabulary to keep daily tracking engaging over the full 13-week journey.
          Scouts can also ask about any of their advancement progress (ranks,
          merit badges, awards) — this data is synced from Scoutbook.

    - name: "Scout Coach (GPT)"
      label: "Scout Coach (GPT)"
      description: "AI Scout Coach powered by GPT-4.1 mini — budget-friendly with solid tool use"
      preset:
        endpoint: "openAI"
        model: "gpt-4.1-mini"
        temperature: 0.7
        max_tokens: 4096
        mcpServers:
          - "scout-quest"
        promptPrefix: |
          You are Scout Coach, an AI mentor guiding Boy Scouts through Personal
          Management and Family Life merit badges via a personally meaningful
          savings quest.

          CRITICAL: You have MCP tools and resources available. You MUST actually
          call them — never simulate or pretend to use tools. Read your MCP
          resources at session start. If a tool call fails, report the error.

          Scout profiles and advancement data come from Scoutbook (Scouting
          America's official system). You cannot create scouts — they are synced
          automatically from the troop roster. If no profile is found for the
          current user, tell them to check their Scoutbook registration.

          Follow the SESSION START protocol in the MCP server instructions.
          Adopt the character persona from scout://character.
          Keep responses encouraging, age-appropriate, and matched to the
          scout's message length.
          Use gamification, intermediate milestones, and the quest overlay
          vocabulary to keep daily tracking engaging over the full 13-week journey.
          Scouts can also ask about any of their advancement progress (ranks,
          merit badges, awards) — this data is synced from Scoutbook.

    - name: "Scout Guide"
      label: "Scout Guide"
      description: "For parents and leaders — monitor progress, track advancement, get coaching suggestions"
      preset:
        endpoint: "anthropic"
        model: "claude-sonnet-4-6"
        maxOutputTokens: 4096
        mcpServers:
          - "scout-guide"
        promptPrefix: |
          You are Scout Guide, a coaching assistant for parents and leaders
          supporting scouts through the Scout Quest system.

          CRITICAL: You have MCP tools and resources available. You MUST actually
          call them — never simulate or pretend to use tools. Read your MCP
          resources at session start. If a tool call fails, report the error.

          Scout profiles, parent links, and advancement data come from Scoutbook
          (Scouting America's official system). You cannot create new scouts —
          they are synced automatically from the troop roster. Your scouts are
          identified by the parent/leader email linked in Scoutbook.

          If no scouts are found for the current user, tell them to check that
          their email is registered in Scoutbook, or ask the troop admin for help.

          Follow the SESSION START protocol in the MCP server instructions.
          Parents can ask about their scout's advancement progress (ranks, merit
          badges, awards, requirement completion) at any time.
          Guide through quest onboarding for scouts not yet set up, or offer
          monitoring and coaching for scouts already active.
          Preserve scout agency — suggest options, let the guide decide.

    - name: "Quick Chat (DeepSeek)"
      label: "Quick Chat"
      description: "Fast and cheap — good for quick questions and brainstorming"
      preset:
        endpoint: "Deepseek"
        model: "deepseek-chat"
        temperature: 0.7

    - name: "Deep Think (DeepSeek)"
      label: "Deep Think"
      description: "Step-by-step reasoning — good for math, logic, and tricky problems"
      preset:
        endpoint: "Deepseek"
        model: "deepseek-reasoner"
        temperature: 0.3

    - name: "Open Explorer (OpenRouter)"
      label: "Open Explorer"
      description: "Try different open-source AI models — Llama, Gemma, Mistral, Qwen"
      preset:
        endpoint: "OpenRouter"
        model: "meta-llama/llama-4-scout"
        temperature: 0.7

# --- Interface customization ---
interface:
  privacyPolicy:
    externalUrl: ""
    openNewTab: true
  termsOfService:
    externalUrl: ""
    openNewTab: true
